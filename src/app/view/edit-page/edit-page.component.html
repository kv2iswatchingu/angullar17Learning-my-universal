<div class="editPage">
    <div class="title">
        创建、上传页面
    </div>

    
    <div class="main">
        <!-- <mat-tab-group>
            <mat-tab>
                <ng-template mat-tab-label>
                    <div class="tabTitle">
                        上传工作区
                    </div>
                </ng-template> -->
                <mat-tab-group class="create">
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                                新建专辑
                            </div>
                        </ng-template>
                        <div class="ablumAdd">
                            
                            <div class="ablumAddMain">
                                <div class="leftlabel">
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>专辑名称</mat-label>
                                            <input matInput type="text" [(ngModel)]="ablumInfo.ablumName">
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>专辑乐队/作者</mat-label>
                                            <input matInput type="text" [(ngModel)]="ablumInfo.ablumBand">
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>专辑时代/年份</mat-label>
                                            <input matInput type="text" [(ngModel)]="ablumInfo.ablumYear">
                                        </mat-form-field>
                                    </div>
                                    
                                    <label class="inputBtn">
                                        <span>选择专辑封面</span>
                                        <input 
                                            class="input"
                                            type="file" 
                                            (change)="uploadCover($event)" 
                                        />
                                    </label>
                                </div>
                                <div class="rightImage">
                                    @if(ablumCover != undefined ){
                                        <img 
                                            class="ablumCover"
                                            src="{{ablumCoverBase64}}"
                                        />
                                    }
                                    @else{
                                        <div class="ablumCoverNone">
                                            <div class="ablumCoverNone-tip">
                                                预览专辑封面
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                            <button
                                class="ablumSubmitBtn"
                                (click)="submitAblumInfo()"
                                mat-flat-button>
                                上传专辑
                            </button>
                        </div>
                    </mat-tab>    
        
                    <mat-tab>    
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                                上传歌曲
                            </div>
                        </ng-template>
                        <div class="musicInfoAdd">
                            <div class="musicInfoAddMain">
                                <div class="leftlabel">
                                    <div>
                                        <mat-form-field>
                                            <mat-label>选择目标专辑</mat-label>
                                            <mat-select [formControl]="ablumControl" required (selectionChange)="ablumChanged()">
                                                <mat-option>--</mat-option>
                                                @for (ablum of ablumList; track ablum) {
                                                <mat-option [value]="ablum">{{ablum.ablumName}}</mat-option>
                                                }
                                            </mat-select>
                                            @if (ablumControl.hasError('required')) {
                                                <mat-error>必需有目标专辑</mat-error>
                                            }
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>歌曲名称</mat-label>
                                            <input matInput type="text" [(ngModel)]="musicInfo.musicName">
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>歌曲歌手</mat-label>
                                            <input matInput type="text" [(ngModel)]="musicInfo.musicSinger">
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>歌曲作者</mat-label>
                                            <input matInput type="text" [(ngModel)]="musicInfo.musicAuthor">
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <mat-form-field class="angularInput">
                                            <mat-label>歌曲风格</mat-label>
                                            <input matInput type="text" [(ngModel)]="musicInfo.musicStyle">
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="middlelabel">
                                    <div class="infoAblum">专辑信息</div>
                                    @if(showCurrentAblum != null){
                                        <div class="infoAblumLabel">
                                            专辑名称：
                                            <span>{{showCurrentAblum.ablumName}}</span>
                                        </div>
                                        <div class="infoAblumLabel">
                                            专辑乐队：
                                            <span>{{showCurrentAblum.ablumBand}}</span>
                                        </div>
                                        <div class="infoAblumLabel">
                                            专辑时代：
                                            <span>{{showCurrentAblum.ablumYear}}</span>
                                        </div>
                                        <div class="infoAblumLabel">
                                            专辑封面：
                                        </div>
                                        <img 
                                            class="infoAblumImg"
                                            src="data:{{showCurrentAblum.coverType}};base64,{{showCurrentAblum.coverRaw}}" 
                                        />
                                    }
                                    @else{
                                        <div class="infoAblumTips">
                                            选择目标专辑后可预览该专辑信息
                                        </div>
                                    }
        
                                    
                                    
                                </div>
                                <div class="rightlabel">
                                    
                                    <label class="inputBtn">
                                        @if(musicInfoRaw == undefined){
                                            <span>选择歌曲</span>
                                        }
                                        @else{
                                            <span>重新选择歌曲</span>
                                        }
                                        <input 
                                            class="input"
                                            type="file" 
                                            (change)="uploadMusic($event)" 
                                        />
                                    </label>
                                    <div class="infoReconedTips" [hidden]="musicInfoRaw != undefined">
                                        选择歌曲后可预览该歌曲元数据
                                    </div>
                                    <audio #audioPlayer controls preload="none" class="audio" [hidden]="musicInfoRaw == undefined">
                                        你的浏览器不支持音频，你是拿IBM访问的吗？
                                    </audio>
                                    @if(musicInfoRaw != undefined){
                                        <div class="infoReconed">
                                            歌曲元数据信息参考：
                                        </div>
                                        <div class="musicJsLabel">
                                            歌曲标题：
                                            <div class="musictext">
                                                {{musicJs.musicTitle}}
                                            </div>
                                        </div>
                                        <div class="musicJsLabel">
                                            歌曲作者、歌手:
                                            <div class="musictext">
                                                {{musicJs.musicSingerAuthor}}
                                            </div>
                                        </div>
                                        <div class="musicJsLabel">
                                            歌曲流派:
                                            <span class="musictextspan">
                                                {{musicJs.musicStyle}}
                                            </span>
                                        </div>
                                        <div class="musicJsLabel">
                                            歌曲时长:
                                            <span class="musictextspan">
                                                {{musicJs.musicDuration | playerTimeFormat}}
                                            </span>
                                        </div>
                                    }
                                </div>
                            </div>
                            <button
                                class="musicSubmitBtn"
                                (click)="submitMusicInfo()"
                                mat-flat-button>
                                上传歌曲
                            </button>
                        </div>
                    </mat-tab>    
        
                    <mat-tab>    
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                                创建歌单
                            </div>
                        </ng-template>
                        <div class="songlistAdd">
                            
                            <div class="songlistAddMain">
                                
                                <div class="leftlabel">
                                    <div class="leaftlabelTilte">
                                        歌单信息
                                    </div>
                                    <div class="leftlabel-up">
                                        <div class="leftlabel-left">
                                                <div>
                                                <mat-form-field class="angularInput">
                                                    <mat-label>歌单名称</mat-label>
                                                    <input matInput type="text" [(ngModel)]="songListPost.songListName">
                                                </mat-form-field>
                                                </div>
                                                <div>
                                                <mat-form-field class="angularInput">
                                                    <mat-label>歌单风格</mat-label>
                                                    <input matInput type="text" [(ngModel)]="songListPost.songListStyle">
                                                </mat-form-field>
                                                </div>
                                                <label class="inputBtn">
                                                <span>选择歌单封面</span>
                                                <input 
                                                    class="input"
                                                    type="file" 
                                                    (change)="uploadSongListImg($event)" 
                                                />
                                                </label>
                                        </div>
                                        <div class="leftlabel-right">
                                            @if(songListImg != undefined ){
                                                <img 
                                                    class="songListImg"
                                                    src="{{songListImgUrl}}"
                                                />
                                            }
                                            @else{
                                                <div class="songListImgNone">
                                                    <div class="songListImgNone-tip">
                                                        预览歌单图片
                                                    </div>
                                                </div>
                                            }
                                        </div>   
                                    </div>
                                    
                                    <div>
                                        <mat-form-field class="angularTextArea">
                                            <mat-label>歌单描述</mat-label>
                                            <textarea 
                                                class="angularTextArea-input"
                                                matInput 
                                                [(ngModel)]="songListPost.songListDesprition">
                                            </textarea>
                                        </mat-form-field>
                                    </div>
                                </div>
        
                                <div class="right">
                                    <div class="rightTitle">
                                        搜寻歌曲
                                    </div>
                                    <div class="rightMain">
                                        <div class="songListSearch">
                                            <div class="songListSearch-check">
                                                <mat-form-field class="angularInput">
                                                    <mat-label>歌曲名称</mat-label>
                                                    <input matInput type="text" [(ngModel)]="musicSearch.name" >
                                                </mat-form-field>
                                            </div>
                    
                                            <div class="songListSearch-check">
                                                <mat-form-field class="angularInput">
                                                    <mat-label>歌曲风格</mat-label>
                                                    <input matInput type="text" [(ngModel)]="musicSearch.style">
                                                </mat-form-field>
                                            </div>
                    
                                            <div class="songListSearch-check">
                                                <mat-form-field class="angularInput">
                                                    <mat-label>歌曲歌手</mat-label>
                                                    <input matInput type="text" [(ngModel)]="musicSearch.singer">
                                                </mat-form-field>
                                            </div>
        
                                            <div class="songListSearch-check">
                                                <mat-form-field class="angularInput">
                                                    <mat-label>歌曲作者</mat-label>
                                                    <input matInput type="text" [(ngModel)]="musicSearch.author">
                                                </mat-form-field>
                                            </div>
                    
                                        </div>
                                        <button 
                                            class="songListSearchBtn" 
                                            mat-flat-button color="accent" 
                                            (click)="searchMusic()">
                                            <mat-icon>search</mat-icon>
                                            <span>获取歌曲信息</span>
                                        </button> 
                                        <mat-selection-list 
                                            class="songListSearchList"
                                            #selectMusic 
                                            (selectionChange)="selectionChange()">
                                            @if(searchMusicList.length > 0){
                                                @for(item of searchMusicList; track item._id){
                                                    <mat-list-option 
                                                        class="list-item" 
                                                        [selected]="musicIdList.includes(item._id)"
                                                        [value]="item._id">
                                                        <div class="list-item-title">
                                                            <span>
                                                                {{item.musicName}}
                                                            </span>
                                                        </div>
                                                        
                                                        <div class="list-item-author">
                                                            <span>
                                                                {{item.musicAuthor}}、
                                                                {{item.musicSinger}}
                                                            </span>
                                                        </div>
                                                        <div class="list-item-style">
                                                            <span>
                                                                {{item.musicStyle}}
                                                            </span>
                                                        </div>
                                                        <div class="list-item-share">
                                                            <div>
                                                                <span>
                                                                    {{item.musicLong | playerTimeFormat}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                        
                                                    </mat-list-option>
                                                }
                                            }
                                            @else if(!searchFirst){
                                                <div class="songListSearchTips">暂无数据</div>
                                            }
                                            @else{
                                                <div class="songListSearchTips">搜索并选择歌曲加入歌单</div>
                                            }
                                        </mat-selection-list>
                                        @if(searchMusicList.length > 0){
                                            <mat-paginator 
                                                #paginator
                                                class="paginator"
                                                [length]="pageLength" 
                                                [pageSize]="6" 
                                                [pageIndex]="pageIndex"
                                                [hidePageSize]="true"
                                                [showFirstLastButtons]="true"
                                                (page)="pageChange($event)"
                                                >
                                            </mat-paginator>
                                        }
                                    </div>
                                        
                                    
                                </div>
                            </div>
                            <button
                                class="songSubmitBtn"
                                mat-flat-button
                                (click)="songListSubmit()">
                                创建歌单
                            </button>
                        </div>
                    </mat-tab>    
                    

                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                                上传歌词
                            </div>
                        </ng-template>
                        <div class="lyricAdd">
                            <div class="lyricRight">
                                <div class="lyricTitle">
                                    搜寻歌曲
                                </div>
                                <div class="lyricRightUpper">
                                    <div class="contentRight">
                                        <div>
                                            <mat-form-field class="angularInput">
                                                <mat-label>歌曲名称</mat-label>
                                                <input matInput type="text" [(ngModel)]="musicSearch.name" >
                                            </mat-form-field>
                                        </div>
                
                                        <div>
                                            <mat-form-field class="angularInput">
                                                <mat-label>歌曲风格</mat-label>
                                                <input matInput type="text" [(ngModel)]="lyricSearch.style">
                                            </mat-form-field>
                                        </div>
                
                                        <div>
                                            <mat-form-field class="angularInput">
                                                <mat-label>歌曲歌手</mat-label>
                                                <input matInput type="text" [(ngModel)]="lyricSearch.singer">
                                            </mat-form-field>
                                        </div>
    
                                        <div>
                                            <mat-form-field class="angularInput">
                                                <mat-label>歌曲作者</mat-label>
                                                <input matInput type="text" [(ngModel)]="lyricSearch.author">
                                            </mat-form-field>
                                        </div>
                                            
                                        <button 
                                            class="musicSearchBtn" 
                                            mat-flat-button color="accent" 
                                            (click)="searchLyric()">
                                            <mat-icon>search</mat-icon>
                                            <span>获取歌曲信息</span>
                                        </button> 
                    
                                    </div>
                                       
                                    <div class="contentLeft">
                                        <mat-selection-list 
                                            class="lyricSearchList"
                                            #selectMusicLyric 
                                            [multiple]="false"
                                            (selectionChange)="selectionLyricChange()">
                                        @if(searchLyricList.length > 0){
                                            @for(item of searchLyricList; track item._id){
                                                <mat-list-option 
                                                    class="list-item" 
                                                    [selected]="musicIdList.includes(item._id)"
                                                    [value]="item._id">
                                                    <div class="list-item-title">
                                                        <span>
                                                            {{item.musicName}}
                                                        </span>
                                                    </div>
                                                    
                                                    <div class="list-item-author">
                                                        <span>
                                                            {{item.musicAuthor}}、
                                                            {{item.musicSinger}}
                                                        </span>
                                                    </div>
                                                    <div class="list-item-style">
                                                        <span>
                                                            {{item.musicStyle}}
                                                        </span>
                                                    </div>
                                                </mat-list-option>

                                            }
                                        }
                                        @else if(!searchLyricFirst){
                                            <div class="lyricSearchTips">暂无数据</div>
                                        }
                                        @else{
                                            <div class="lyricSearchTips">搜索并选择歌曲以上传对应歌词</div>
                                        }
                                        </mat-selection-list>
                                        @if(searchLyricList.length > 0){
                                            <mat-paginator 
                                                #paginator
                                                class="paginator"
                                                [length]="pagelyricLength" 
                                                [pageSize]="7" 
                                                [pageIndex]="pagelyricIndex"
                                                [hidePageSize]="true"
                                                [showFirstLastButtons]="true"
                                                (page)="pageChangeLyric($event)"
                                                >
                                            </mat-paginator>
                                        }
                                    </div>



                                    
                                    
                                </div>
                                <div class="infoMusic">歌曲信息</div>
                                <audio 
                                    #lyricPlayer 
                                    controls 
                                    preload="none" 
                                    class="lyricaudio"
                                    [hidden]="searchLyricCurrentInfo == undefined"
                                >
                                    你的浏览器不支持音频，你是拿IBM访问的吗？
                                </audio>
                                <div class="lyricRightInfo">
                                    
                                    @if(searchLyricCurrentInfo != undefined){
                                        <div class="infoMusicRight">
                                            <div class="infoMusicLabel">
                                                歌曲名称：
                                                <span>{{searchLyricCurrentInfo.musicName}}</span>
                                            </div>
                                            <div class="infoMusicLabel">
                                                歌曲作者：
                                                <span>{{searchLyricCurrentInfo.musicAuthor}}</span>
                                            </div>
                                            <div class="infoMusicLabel">
                                                歌曲歌手：
                                                <span>{{searchLyricCurrentInfo.musicSinger}}</span>
                                            </div>
                                            <div class="infoMusicLabel">
                                                歌曲风格：
                                                <span>{{searchLyricCurrentInfo.musicStyle}}</span>
                                            </div>
                                            <div class="infoMusicLabel">
                                                歌曲风格：
                                                <span>{{searchLyricCurrentInfo.musicStyle}}</span>
                                            </div>
                                            <div class="infoMusicLabel">
                                                歌曲风格：
                                                <span>{{searchLyricCurrentInfo.musicStyle}}</span>
                                            </div>
                                            
                                        </div>
                                        <div class="infoMusicLeft">
                                            <div class="infoMusicLabel">
                                                歌曲、专辑封面：
                                            </div>
                                            <img 
                                                class="infoMusicImg"
                                                src="data:{{searchLyricCurrentInfo.coverType}};base64,{{searchLyricCurrentInfo.coverRaw}}" 
                                            />
                                        </div>
                                        
                                    }
                                    @else{
                                        <div class="infoMusicTips">
                                            选择目标歌曲后可预览该歌曲信息
                                        </div>
                                    }
                                </div>
                            </div>
                            
                            <div class="lyricLeft">
                                <div class="lyricTitle">
                                    歌词编辑、上传
                                </div>
                                
                                
                                <label [ngClass]="lyricRaw._MusicInfoId == '' ? 'lyricBtnDis' : 'lyricBtn'">
                                    <span>选择lyric文件</span>
                                    <input 
                                        [disabled]="lyricRaw._MusicInfoId == ''"
                                        class="input"
                                        type="file" 
                                        (change)="uploadLyric($event)" 
                                    />
                                </label>

                                <mat-form-field class="lyricTextArea">
                                    <mat-label>歌词编辑</mat-label>
                                    <textarea 
                                        class="lyricTextArea-input"
                                        matInput 
                                        [(ngModel)]="lyricRaw.lyricContent">
                                    </textarea>
                                </mat-form-field>
                            </div>
                           
                            
                                    
                        </div>
                        <button
                                class="lyricSubmitBtn"
                                mat-flat-button
                                (click)="lyricSubmit()">
                                上传歌词
                        </button>
                    </mat-tab>
                </mat-tab-group>
           <!--  </mat-tab>

            <mat-tab>
                <ng-template mat-tab-label>
                    <div class="tabTitle">
                        编辑工作区
                    </div>
                </ng-template>
                <mat-tab-group class="edit">
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                               修改专辑信息
                            </div>
                        </ng-template>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                                修改歌曲信息
                            </div>
                        </ng-template>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <div class="tabTitle">
                               修改歌单信息
                            </div>
                        </ng-template>
                    </mat-tab>
                    
                </mat-tab-group>





            </mat-tab>
        </mat-tab-group> -->
    </div>
</div>

